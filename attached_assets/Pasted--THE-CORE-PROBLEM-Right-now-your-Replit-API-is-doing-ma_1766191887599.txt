ğŸ§  THE CORE PROBLEM

Right now, your Replit API is doing manual token matching like:

if (title.includes("kids") || categories.includes("children")) ...


Thatâ€™s brittle â€” you have to manually add every variation (kids, children, toddlers, junior, etc.).

We need to replace that logic with semantic search, so one query automatically finds related terms using a prebuilt synonym list or fuzzy match.

âš™ï¸ 3 OPTIONS TO â€œKILL IT IN ONE GOâ€
ğŸ©µ Option 1 â€” Global Synonym Map (recommended)

Load a single master dictionary once at startup and expand every query dynamically.

// synonyms.js
export const globalSynonyms = {
  kids: ["child", "children", "toddler", "baby", "junior", "youth", "infant", "family"],
  clothes: ["clothing", "wear", "fashion", "apparel", "outfit"],
  toys: ["games", "lego", "playset", "puzzles", "plush", "stuffed animals"],
  shoes: ["trainers", "footwear", "sneakers", "boots", "sandals"],
  lunch: ["lunchbox", "food container", "snack box", "flask"],
  travel: ["holiday", "trip", "days out", "getaway", "theme park"],
  // etc.
};


Then in your query handler:

import { globalSynonyms } from "./synonyms.js";

function expandQuery(userQuery) {
  const words = userQuery.toLowerCase().split(/\s+/);
  const expanded = new Set(words);
  words.forEach(word => {
    if (globalSynonyms[word]) {
      globalSynonyms[word].forEach(s => expanded.add(s));
    }
  });
  return [...expanded];
}


Then your filtering logic just loops over all expanded terms instead of direct includes.

âœ… Pros:

One central file covers every term.

Add new synonyms anytime, instantly global.

Doesnâ€™t change your API shape â€” GPT calls still look the same.

ğŸ’š Option 2 â€” Fuzzy / Full-Text Search

If you want zero manual synonym upkeep at all, use a fuzzy match library:

npm install fuse.js


Then:

import Fuse from "fuse.js";

const fuse = new Fuse(offers, {
  keys: ["title", "description", "categories", "merchant"],
  threshold: 0.35, // 0 = exact, 1 = very loose
});

app.get("/shopping/awin-link", (req, res) => {
  const { query } = req.query;
  const results = fuse.search(query);
  res.json(results.slice(0, 50));
});


âœ… Pros:

No synonym table needed.

Automatically matches related words like â€œtrainerâ€ for â€œshoeâ€, â€œschoolâ€ for â€œeducationâ€.
ğŸš« Con: Slightly heavier on CPU (fine for <2k offers).

ğŸ©· Option 3 â€” Hybrid (best of both worlds)

Combine the synonym expander (Option 1) and Fuse.js fuzzy matching for maximum recall:

const expanded = expandQuery(userQuery);
const searchString = expanded.join(" ");
const results = fuse.search(searchString);


That gives you perfect balance â€” broad but still relevant.

ğŸ”§ QUICK IMPLEMENTATION PLAN

1ï¸âƒ£ Drop a synonyms.js file into your Replit project.
2ï¸âƒ£ Add fuse.js or your chosen lightweight fuzzy search.
3ï¸âƒ£ Replace the manual if (includes) logic with the hybrid method above.
4ï¸âƒ£ Re-publish.

Now Sunnyâ€™s getShoppingDeals calls will automatically find every related offer â€” no more one-by-one synonym work.